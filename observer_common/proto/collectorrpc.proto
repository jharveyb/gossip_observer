syntax = "proto3";

package collectorrpc;

import "common.proto";

// TODO: make some of these streaming?
service CollectorService {
  rpc GetNodeConfig(NodeConfigRequest) returns (NodeConfigResponse);
  rpc PostEligiblePeers(EligiblePeersRequest) returns (EligiblePeersResponse);
  rpc PostTargetPeerCount(TargetPeerCountRequest) returns (TargetPeerCountResponse);
  rpc GetCurrentPeers(CurrentPeersRequest) returns (CurrentPeersResponse);
  rpc Balances(common.BalancesRequest) returns (common.BalancesResponse);
  rpc OpenChannel(common.OpenChannelRequest) returns (common.OpenChannelResponse);
  rpc Shutdown(common.ShutdownRequest) returns (common.ShutdownResponse);
}

message NodeConfigRequest {}

message NodeConfigResponse {
  repeated common.SocketAddress listen_addrs = 1;
  optional common.NodeAlias node_alias = 2;
  common.Pubkey node_id = 3;
}

message PeerDetails {
  common.Pubkey pubkey = 1;
  common.SocketAddress socket_addr = 2;
  bool is_persisted = 3;
  bool is_connected = 4;
}

message EligiblePeersRequest {
  repeated common.PeerConnectionInfo peers = 1;
}

message EligiblePeersResponse {}

message CurrentPeersRequest {}

message CurrentPeersResponse {
  repeated PeerDetails peers = 1;
}

message TargetPeerCountRequest {
  uint32 target = 1;
}

message TargetPeerCountResponse {}

syntax = "proto3";

package collector;

service CollectorService {
  rpc GetNodeConfig(NodeConfigRequest) returns (NodeConfigResponse);
  rpc PostEligiblePeers(EligiblePeersRequest) returns (EligiblePeersResponse);
  rpc PostTargetPeerCount(TargetPeerCountRequest) returns (TargetPeerCountResponse);
  rpc GetCurrentPeers(CurrentPeersRequest) returns (CurrentPeersResponse);
}

message NodeConfigRequest {}

message NodeConfigResponse {
  repeated string listen_addrs = 1;
  optional bytes node_alias = 2;
  string node_id = 3;
}

message PeerConnectionInfo {
  string pubkey = 1;
  repeated string socket_addrs = 2;
}

message PeerDetails {
  string pubkey = 1;
  string socket_addr = 2;
  bool is_persisted = 3;
  bool is_connected = 4;
}

message EligiblePeersRequest {
  repeated PeerConnectionInfo peers = 1;
}

message EligiblePeersResponse {}

message CurrentPeersRequest {}

message CurrentPeersResponse {
  repeated PeerDetails peers = 1;
}

message TargetPeerCountRequest {
  uint32 target = 1;
}

message TargetPeerCountResponse {}